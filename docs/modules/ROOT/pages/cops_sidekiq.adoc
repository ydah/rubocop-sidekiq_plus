////
  Do NOT edit this file by hand directly, as it is automatically generated.

  Please make any necessary changes to the cop documentation within the source files themselves.
////

= Sidekiq

[#sidekiqactiverecordargument]
== Sidekiq/ActiveRecordArgument

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for ActiveRecord objects passed to Sidekiq job methods.

Passing ActiveRecord objects to Sidekiq jobs is problematic because:
- Objects cannot be properly serialized to JSON
- The object may change or be deleted before the job runs
- It increases Redis memory usage

Instead, pass the record's ID and reload it in the job.

[#examples-sidekiqactiverecordargument]
=== Examples

[source,ruby]
----
# bad
MyJob.perform_async(user)
MyJob.perform_async(User.find(1))
MyJob.perform_async(User.first)

# good
MyJob.perform_async(user.id)
MyJob.perform_async(user_id)
----

[#references-sidekiqactiverecordargument]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/ActiveRecordArgument

[#sidekiqasyncintest]
== Sidekiq/AsyncInTest

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for perform_async usage in test files.

[#examples-sidekiqasyncintest]
=== Examples

[source,ruby]
----
# bad
MyJob.perform_async(user.id)

# good
MyJob.perform_inline(user.id)
----

[#configurable-attributes-sidekiqasyncintest]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| Include
| `+spec/**/*_spec.rb+`, `+test/**/*_test.rb+`
| Array
|===

[#references-sidekiqasyncintest]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/AsyncInTest

[#sidekiqconsistentjobsuffix]
== Sidekiq/ConsistentJobSuffix

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Enforces consistent job class name suffix (Job or Worker).

[#examples-sidekiqconsistentjobsuffix]
=== Examples

[#enforcedsuffix_-job-_default_-sidekiqconsistentjobsuffix]
==== EnforcedSuffix: Job (default)

[source,ruby]
----
# bad
class ProcessPaymentWorker
  include Sidekiq::Job
end

# good
class ProcessPaymentJob
  include Sidekiq::Job
end
----

[#configurable-attributes-sidekiqconsistentjobsuffix]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| EnforcedSuffix
| `Job`
| `<none>`
|===

[#references-sidekiqconsistentjobsuffix]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/ConsistentJobSuffix

[#sidekiqconstantjobclassname]
== Sidekiq/ConstantJobClassName

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks that job class names are constants.

Using dynamic class names for jobs can lead to:
- Security vulnerabilities (arbitrary code execution)
- Difficult to trace job execution
- Harder static analysis

[#examples-sidekiqconstantjobclassname]
=== Examples

[source,ruby]
----
# bad
job_class.perform_async(args)
"#{prefix}Job".constantize.perform_async(args)

# good
MyJob.perform_async(args)
MyModule::MyJob.perform_async(args)
----

[#references-sidekiqconstantjobclassname]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/ConstantJobClassName

[#sidekiqdatabaseconnectionleak]
== Sidekiq/DatabaseConnectionLeak

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for explicit ActiveRecord connection usage in Sidekiq jobs.

[#examples-sidekiqdatabaseconnectionleak]
=== Examples

[source,ruby]
----
# bad
ActiveRecord::Base.connection.execute('SELECT 1')

# good
ActiveRecord::Base.connection_pool.with_connection { |conn| conn.execute('SELECT 1') }
----

[#references-sidekiqdatabaseconnectionleak]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/DatabaseConnectionLeak

[#sidekiqdatetimeargument]
== Sidekiq/DateTimeArgument

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for Date/Time/DateTime objects passed to Sidekiq job methods.

Date and Time objects should be converted to strings or timestamps
before being passed to Sidekiq jobs to ensure proper serialization.

[#examples-sidekiqdatetimeargument]
=== Examples

[source,ruby]
----
# bad
MyJob.perform_async(Time.current)
MyJob.perform_async(Date.today)
MyJob.perform_async(DateTime.now)

# good
MyJob.perform_async(Time.current.iso8601)
MyJob.perform_async(Date.today.to_s)
MyJob.perform_async(Time.current.to_i)
----

[#references-sidekiqdatetimeargument]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/DateTimeArgument

[#sidekiqdeprecateddefaultworkeroptions]
== Sidekiq/DeprecatedDefaultWorkerOptions

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| Always
| 0.1
| -
|===

Checks for deprecated Sidekiq.default_worker_options usage.

[#examples-sidekiqdeprecateddefaultworkeroptions]
=== Examples

[source,ruby]
----
# bad
Sidekiq.default_worker_options = { retry: 5 }

# good
Sidekiq.default_job_options = { retry: 5 }
----

[#references-sidekiqdeprecateddefaultworkeroptions]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/DeprecatedDefaultWorkerOptions

[#sidekiqdeprecateddelayextension]
== Sidekiq/DeprecatedDelayExtension

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for deprecated delay extension usage.

[#examples-sidekiqdeprecateddelayextension]
=== Examples

[source,ruby]
----
# bad
UserMailer.delay.welcome_email(user)

# good
UserMailer.welcome_email(user).deliver_later
----

[#references-sidekiqdeprecateddelayextension]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/DeprecatedDelayExtension

[#sidekiqdeprecatedworkermodule]
== Sidekiq/DeprecatedWorkerModule

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| Always
| 0.1
| -
|===

Checks for Sidekiq::Worker usage and recommends Sidekiq::Job.

[#examples-sidekiqdeprecatedworkermodule]
=== Examples

[source,ruby]
----
# bad
class MyWorker
  include Sidekiq::Worker
end

# good
class MyJob
  include Sidekiq::Job
end
----

[#references-sidekiqdeprecatedworkermodule]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/DeprecatedWorkerModule

[#sidekiqenqueueinefficiency]
== Sidekiq/EnqueueInefficiency

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for perform_async calls inside loops and recommends perform_bulk.

[#examples-sidekiqenqueueinefficiency]
=== Examples

[source,ruby]
----
# bad
users.each do |user|
  NotifyJob.perform_async(user.id)
end

# good
user_ids = users.map { |user| [user.id] }
NotifyJob.perform_bulk(user_ids)
----

[#configurable-attributes-sidekiqenqueueinefficiency]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedMethods
| `each`, `find_each`, `find_in_batches`
| Array

| MinimumIterations
| `<none>`
| 
|===

[#references-sidekiqenqueueinefficiency]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/EnqueueInefficiency

[#sidekiqexcessiveretry]
== Sidekiq/ExcessiveRetry

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for excessive retry counts in sidekiq_options.

[#examples-sidekiqexcessiveretry]
=== Examples

[#maxretries_-25-_default_-sidekiqexcessiveretry]
==== MaxRetries: 25 (default)

[source,ruby]
----
# bad
sidekiq_options retry: 100
----

[#configurable-attributes-sidekiqexcessiveretry]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| MaxRetries
| `25`
| Integer
|===

[#references-sidekiqexcessiveretry]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/ExcessiveRetry

[#sidekiqfindeachinjob]
== Sidekiq/FindEachInJob

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for find_each/find_in_batches usage inside Sidekiq job perform methods.

[#examples-sidekiqfindeachinjob]
=== Examples

[source,ruby]
----
# bad
class ProcessAllUsersJob
  include Sidekiq::Job

  def perform
    User.find_each { |user| process(user) }
  end
end

# good
class ProcessUserJob
  include Sidekiq::Job

  def perform(user_id)
    user = User.find(user_id)
    process(user)
  end
end
----

[#configurable-attributes-sidekiqfindeachinjob]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedMethods
| `[]`
| Array
|===

[#references-sidekiqfindeachinjob]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/FindEachInJob

[#sidekiqhugejobarguments]
== Sidekiq/HugeJobArguments

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for potentially huge arguments passed to Sidekiq jobs.

[#examples-sidekiqhugejobarguments]
=== Examples

[source,ruby]
----
# bad
MyJob.perform_async(users.pluck(:id, :name, :email))
MyJob.perform_async([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11])

# good
MyJob.perform_async(user_ids)
----

[#configurable-attributes-sidekiqhugejobarguments]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| MaxArraySize
| `10`
| Integer

| MaxHashSize
| `10`
| Integer

| MaxPluckColumns
| `3`
| Integer
|===

[#references-sidekiqhugejobarguments]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/HugeJobArguments

[#sidekiqjobdependency]
== Sidekiq/JobDependency

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for implicit job dependencies (enqueuing other jobs inside jobs).

[#examples-sidekiqjobdependency]
=== Examples

[source,ruby]
----
# bad
def perform
  SecondJob.perform_async
end
----

[#references-sidekiqjobdependency]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/JobDependency

[#sidekiqjobfilelocation]
== Sidekiq/JobFileLocation

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks that Sidekiq job classes are located in allowed directories.

[#examples-sidekiqjobfilelocation]
=== Examples

[source,ruby]
----
# bad - app/models/send_email_job.rb
class SendEmailJob
  include Sidekiq::Job
end

# good - app/jobs/send_email_job.rb
class SendEmailJob
  include Sidekiq::Job
end
----

[#configurable-attributes-sidekiqjobfilelocation]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedDirectories
| `app/jobs`, `app/workers`
| Array
|===

[#references-sidekiqjobfilelocation]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/JobFileLocation

[#sidekiqjobfilenaming]
== Sidekiq/JobFileNaming

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks that job file names match the class name.

[#examples-sidekiqjobfilenaming]
=== Examples

[source,ruby]
----
# bad - file: send_email_worker.rb
class SendEmailJob
  include Sidekiq::Job
end
----

[#references-sidekiqjobfilenaming]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/JobFileNaming

[#sidekiqjobinclude]
== Sidekiq/JobInclude

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| Always
| 0.1
| -
|===

Checks that Sidekiq jobs include the preferred module.

Sidekiq::Worker was renamed to Sidekiq::Job in Sidekiq 6.3.
Sidekiq::Job is the preferred module name.

[#examples-sidekiqjobinclude]
=== Examples

[#preferredmodule_-job-_default_-sidekiqjobinclude]
==== PreferredModule: Job (default)

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Worker
end

# good
class MyJob
  include Sidekiq::Job
end
----

[#preferredmodule_-worker-sidekiqjobinclude]
==== PreferredModule: Worker

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job
end

# good
class MyJob
  include Sidekiq::Worker
end
----

[#configurable-attributes-sidekiqjobinclude]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| PreferredModule
| `Job`
| String
|===

[#references-sidekiqjobinclude]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/JobInclude

[#sidekiqmissinglogging]
== Sidekiq/MissingLogging

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for missing logging in Sidekiq job perform methods.

[#examples-sidekiqmissinglogging]
=== Examples

[source,ruby]
----
# bad
def perform(user_id)
  do_work(user_id)
end

# good
def perform(user_id)
  logger.info "Starting job for #{user_id}"
  do_work(user_id)
end
----

[#references-sidekiqmissinglogging]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/MissingLogging

[#sidekiqmissingtimeout]
== Sidekiq/MissingTimeout

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for network calls without explicit timeouts in Sidekiq jobs.

[#examples-sidekiqmissingtimeout]
=== Examples

[source,ruby]
----
# bad
Net::HTTP.get(URI(url))

# good
http.open_timeout = 5
http.read_timeout = 10
----

[#references-sidekiqmissingtimeout]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/MissingTimeout

[#sidekiqmixedretrystrategies]
== Sidekiq/MixedRetryStrategies

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for mixed ActiveJob and Sidekiq retry strategies in the same job.

[#examples-sidekiqmixedretrystrategies]
=== Examples

[source,ruby]
----
# bad
class MyJob < ApplicationJob
  retry_on SomeError
  sidekiq_options retry: 5
end
----

[#references-sidekiqmixedretrystrategies]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/MixedRetryStrategies

[#sidekiqnorescueall]
== Sidekiq/NoRescueAll

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for bare `rescue` or `rescue Exception` in Sidekiq jobs.

Rescuing all exceptions can hide bugs and prevent Sidekiq's retry
mechanism from working properly. If you need to handle errors,
rescue specific exception classes and consider re-raising.

[#examples-sidekiqnorescueall]
=== Examples

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job

  def perform
    do_work
  rescue
    log_error
  end
end

# bad
class MyJob
  include Sidekiq::Job

  def perform
    do_work
  rescue Exception
    log_error
  end
end

# good
class MyJob
  include Sidekiq::Job

  def perform
    do_work
  rescue NetworkError => e
    log_error(e)
    raise
  end
end
----

[#references-sidekiqnorescueall]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/NoRescueAll

[#sidekiqperforminlineusage]
== Sidekiq/PerformInlineUsage

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for usage of `perform_inline` in production code.

`perform_inline` executes the job synchronously, bypassing the
job queue. This can be useful in tests but should generally be
avoided in production code.

[#examples-sidekiqperforminlineusage]
=== Examples

[#allowedintests_-true-_default_-sidekiqperforminlineusage]
==== AllowedInTests: true (default)

[source,ruby]
----
# bad (in app/services/user_service.rb)
MyJob.perform_inline(user.id)

# good (in spec/jobs/my_job_spec.rb)
MyJob.perform_inline(user.id)
----

[#allowedintests_-false-sidekiqperforminlineusage]
==== AllowedInTests: false

[source,ruby]
----
# bad (in any file)
MyJob.perform_inline(user.id)
----

[#configurable-attributes-sidekiqperforminlineusage]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedInTests
| `true`
| Boolean
|===

[#references-sidekiqperforminlineusage]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/PerformInlineUsage

[#sidekiqperformmethodparameters]
== Sidekiq/PerformMethodParameters

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks that the perform method does not use keyword arguments.

Sidekiq serializes job arguments to JSON, which does not support
Ruby keyword arguments. Using keyword arguments will cause errors
or unexpected behavior.

[#examples-sidekiqperformmethodparameters]
=== Examples

[source,ruby]
----
# bad
def perform(user_id:, status:)
end

# bad
def perform(id, status: 'pending')
end

# good
def perform(user_id, status)
end
----

[#references-sidekiqperformmethodparameters]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/PerformMethodParameters

[#sidekiqpiiinarguments]
== Sidekiq/PiiInArguments

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for PII passed as Sidekiq job arguments.

[#examples-sidekiqpiiinarguments]
=== Examples

[source,ruby]
----
# bad
NotifyJob.perform_async(email: 'user@example.com')

# good
NotifyJob.perform_async(user_id)
----

[#configurable-attributes-sidekiqpiiinarguments]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| PiiPatterns
| `email`, `phone`, `address`
| Array
|===

[#references-sidekiqpiiinarguments]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/PiiInArguments

[#sidekiqputsorprintusage]
== Sidekiq/PutsOrPrintUsage

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for puts/print usage inside Sidekiq jobs.

[#examples-sidekiqputsorprintusage]
=== Examples

[source,ruby]
----
# bad
puts 'Processing...'

# good
logger.info 'Processing...'
----

[#references-sidekiqputsorprintusage]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/PutsOrPrintUsage

[#sidekiqqueuespecified]
== Sidekiq/QueueSpecified

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks that Sidekiq jobs have an explicit queue specified.

Without an explicit queue, jobs go to the `default` queue.
Specifying queues helps with job organization and prioritization.

[#examples-sidekiqqueuespecified]
=== Examples

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job
end

# good
class MyJob
  include Sidekiq::Job
  sidekiq_options queue: :critical
end
----

[#references-sidekiqqueuespecified]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/QueueSpecified

[#sidekiqredisinjob]
== Sidekiq/RedisInJob

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for direct Redis connections inside Sidekiq jobs.

[#examples-sidekiqredisinjob]
=== Examples

[source,ruby]
----
# bad
redis = Redis.new

# good
Sidekiq.redis { |conn| conn.get('key') }
----

[#references-sidekiqredisinjob]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/RedisInJob

[#sidekiqretryspecified]
== Sidekiq/RetrySpecified

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks that Sidekiq jobs have explicit retry configuration.

Without explicit retry configuration, jobs use the default retry
setting (25 retries). Being explicit about retry behavior makes
the job's error handling clearer.

[#examples-sidekiqretryspecified]
=== Examples

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job
end

# good
class MyJob
  include Sidekiq::Job
  sidekiq_options retry: 5
end

# good
class MyJob
  include Sidekiq::Job
  sidekiq_options retry: false
end
----

[#references-sidekiqretryspecified]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/RetrySpecified

[#sidekiqretryzero]
== Sidekiq/RetryZero

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for retry: 0 usage and suggests retry: false for clarity.

[#examples-sidekiqretryzero]
=== Examples

[source,ruby]
----
# bad
sidekiq_options retry: 0

# good
sidekiq_options retry: false
----

[#references-sidekiqretryzero]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/RetryZero

[#sidekiqselfschedulingjob]
== Sidekiq/SelfSchedulingJob

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Checks for jobs that reschedule themselves.

[#examples-sidekiqselfschedulingjob]
=== Examples

[source,ruby]
----
# bad
def perform
  self.class.perform_in(1.hour)
end
----

[#references-sidekiqselfschedulingjob]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SelfSchedulingJob

[#sidekiqsensitivedatainarguments]
== Sidekiq/SensitiveDataInArguments

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for sensitive data passed as Sidekiq job arguments.

[#examples-sidekiqsensitivedatainarguments]
=== Examples

[source,ruby]
----
# bad
UserJob.perform_async(user_id, password)

# good
UserJob.perform_async(user_id)
----

[#configurable-attributes-sidekiqsensitivedatainarguments]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| SensitivePatterns
| `password`, `passwd`, `pwd`, `token`, `api_key`, `secret`, `credit_card`, `card_number`, `cvv`, `ssn`
| Array
|===

[#references-sidekiqsensitivedatainarguments]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SensitiveDataInArguments

[#sidekiqsidekiqoveractivejob]
== Sidekiq/SidekiqOverActiveJob

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Disabled
| Yes
| No
| 0.1
| -
|===

Recommends using Sidekiq::Job over ActiveJob.

[#examples-sidekiqsidekiqoveractivejob]
=== Examples

[source,ruby]
----
# bad
class MyJob < ApplicationJob
  def perform; end
end

# good
class MyJob
  include Sidekiq::Job
end
----

[#references-sidekiqsidekiqoveractivejob]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SidekiqOverActiveJob

[#sidekiqsilentrescue]
== Sidekiq/SilentRescue

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for rescue blocks that swallow exceptions in Sidekiq jobs.

[#examples-sidekiqsilentrescue]
=== Examples

[source,ruby]
----
# bad
def perform
  do_work
rescue => e
  Rails.logger.error(e)
end

# good
def perform
  do_work
rescue => e
  Rails.logger.error(e)
  raise
end
----

[#configurable-attributes-sidekiqsilentrescue]
=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedExceptions
| `ActiveRecord::RecordNotFound`
| Array
|===

[#references-sidekiqsilentrescue]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SilentRescue

[#sidekiqsleepinjobs]
== Sidekiq/SleepInJobs

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for `sleep` calls inside Sidekiq jobs.

Using `sleep` in a Sidekiq job blocks the worker thread and prevents
it from processing other jobs. Instead, use `perform_in` or
`perform_at` to schedule the job for later.

[#examples-sidekiqsleepinjobs]
=== Examples

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job

  def perform
    sleep 5
  end
end

# good - use perform_in instead
MyJob.perform_in(5.seconds, args)
----

[#references-sidekiqsleepinjobs]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SleepInJobs

[#sidekiqsymbolargument]
== Sidekiq/SymbolArgument

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| Always
| 0.1
| -
|===

Checks for symbol arguments passed to Sidekiq job methods.

Symbols cannot be properly serialized to JSON and will be converted
to strings. This can lead to unexpected behavior.

[#examples-sidekiqsymbolargument]
=== Examples

[source,ruby]
----
# bad
MyJob.perform_async(:status)
MyJob.perform_async(key: :value)
MyJob.perform_in(1.hour, :pending)

# good
MyJob.perform_async('status')
MyJob.perform_async(key: 'value')
MyJob.perform_in(1.hour, 'pending')
----

[#references-sidekiqsymbolargument]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/SymbolArgument

[#sidekiqthreadinjob]
== Sidekiq/ThreadInJob

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for thread creation inside Sidekiq jobs.

Creating threads inside Sidekiq jobs is problematic because:
- Sidekiq already manages its own thread pool
- Threads may not complete before the job finishes
- It can lead to resource leaks and unexpected behavior

[#examples-sidekiqthreadinjob]
=== Examples

[source,ruby]
----
# bad
class MyJob
  include Sidekiq::Job

  def perform
    Thread.new { do_work }
  end
end

# good - use separate jobs instead
class MyJob
  include Sidekiq::Job

  def perform
    SubJob.perform_async
  end
end
----

[#references-sidekiqthreadinjob]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/ThreadInJob

[#sidekiqtransactionleak]
== Sidekiq/TransactionLeak

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for Sidekiq jobs enqueued inside database transactions.

Enqueuing jobs inside a transaction can lead to race conditions where
the job runs before the transaction commits, causing the job to see
stale data or fail to find the record.

[#examples-sidekiqtransactionleak]
=== Examples

[source,ruby]
----
# bad
ActiveRecord::Base.transaction do
  user.save!
  NotificationJob.perform_async(user.id)
end

# good - enqueue after transaction
user.save!
NotificationJob.perform_async(user.id)

# good - use after_commit callback
class User < ApplicationRecord
  after_commit :send_notification, on: :create

  def send_notification
    NotificationJob.perform_async(id)
  end
end
----

[#references-sidekiqtransactionleak]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/TransactionLeak

[#sidekiqunknownsidekiqoption]
== Sidekiq/UnknownSidekiqOption

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| 0.1
| -
|===

Checks for unknown or unsupported options passed to sidekiq_options.

[#examples-sidekiqunknownsidekiqoption]
=== Examples

[source,ruby]
----
# bad
sidekiq_options priority: :high
sidekiq_options unique: true

# good
sidekiq_options queue: :critical, retry: 5
----

[#references-sidekiqunknownsidekiqoption]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/UnknownSidekiqOption

[#sidekiqunsafequeueoperation]
== Sidekiq/UnsafeQueueOperation

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| No
| No
| <<next>>
| -
|===

Checks for unsafe Sidekiq queue/set iteration and lookup operations.

The Sidekiq API operates on shared mutable data structures within Redis
without locks. Iteration through queues/sets is best effort and results
cannot be guaranteed. For example, `find_job` might miss a job if the
queue is mutated during iteration.

These operations are not scalable and should not be used in an automated
fashion or in bulk as part of your application functionality.

[#safety-sidekiqunsafequeueoperation]
=== Safety

This cop may flag legitimate uses in rake tasks or manual repair scripts.
Use `# rubocop:disable` comments for those cases.

[#examples-sidekiqunsafequeueoperation]
=== Examples

[source,ruby]
----
# bad - find_job has race conditions
Sidekiq::Queue.new.find_job(jid)

# bad - iterating and deleting jobs
Sidekiq::Queue.new.each { |job| job.delete }

# bad - scanning retry set
Sidekiq::RetrySet.new.select { |job| job.jid == jid }

# bad - scanning scheduled set
Sidekiq::ScheduledSet.new.find { |job| job.item['class'] == 'MyJob' }

# good - use Sidekiq Pro's delete_job/delete_by_class if available
# or reconsider the design to avoid queue scanning
----

[#references-sidekiqunsafequeueoperation]
=== References

* https://www.rubydoc.info/gems/rubocop-sidekiq_plus/RuboCop/Cop/Sidekiq/UnsafeQueueOperation
